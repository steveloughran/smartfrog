<project name="ivy-mixin" 
    xmlns:ivy="antlib:fr.jayasoft.ivy.ant">

  <description>
    These targets extend compile-and-jar with extra states and transitions,
    to do pom-based builds.
  </description>

  <import file="core.xml"/>
  <!--<import file="state.xml"/>-->


  <target name="ivy-init" depends="init-core,load-version-info,artifact-names">
    <property name="ivy.dir" location="${root.dir}/antbuild/ivy" />
    <fail >
      <condition >
        <not>
          <typefound uri="antlib:fr.jayasoft.ivy.ant" name="retrieve"/>
        </not>
      </condition>
      You need the ivy tasks from http://www.jayasoft.org/ivy/download
      ivy.jar should be installed in ANT_HOME/lib or ${user.home}/.ant/lib
    </fail>
    <!--copy ivy artifacts -->
    <property name="ivy.lib.dir" location="${build.dir}/ivy/lib" />
    <ivy:configure file="${ivy.dir}/ivyconf.xml"/>
  </target>

  <target name="ivy-resolve" depends="ivy-init">
    <ivy:resolve />
  </target>

  <target name="ivy-retrieve" depends="ivy-resolve">
    <ivy:retrieve pattern="${ivy.lib.dir}/[conf]/[artifact]-[revision].[ext]" sync="true" />
  </target>

  <target name="ivy-report" depends="ivy-resolve">
    <ivy:report todir="${build.dir}/ivy/report"/>
  </target>

  <target name="ready-to-publish" depends="packaged,ivy-report"/>

  <target name="ivy-publish" depends="ready-to-publish">
    <ivy:publish resolver="local" pubrevision="${artifact.version}"
        overwrite="true"
        artifactspattern="${dist.dir}/[artifact]-[revision].[ext]" />
  </target>


  <!--
    this target does the local install, copy
  -->

  <target name="ivy-install" depends="ivy-publish"
      description="Component built and installed locally"/>

</project>