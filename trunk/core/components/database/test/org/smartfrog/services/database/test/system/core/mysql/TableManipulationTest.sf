
#include "/org/smartfrog/services/database/test/system/core/mysql/components.sf";


TableManipulationTest extends TestCompound {

    description "Creates users and tables";
    sfShouldTerminate false;

    action extends DatabaseAndBinding {
    }

    tests extends Sequence {


        wait extends FailingWaitFor {
          condition extends IsJdbcConnectionOpen {
            database LAZY action:binding;
          }
         interval 200;
         timeout 10000;
        }


        dropUser1 extends DropUser {
          database LAZY ATTRIB action:binding;
          username testUser;
          failOnSqlError false;
        }

        //forward reference
        dropTable1 extends dropTable {
          failOnSqlError false;
        }

        newuser extends CreateUser {
          database LAZY PARENT:PARENT:action:binding;
          username testUser;
          password testPass;
        }


        events extends CreateEventsTable {
          database LAZY ATTRIB action:binding;
        }

        select extends Transaction {
          database LAZY ATTRIB action:binding;
          sqlCommands [
            "SELECT * from events"
            ];
        }

        dropTable extends DropTable {
            database LAZY ATTRIB action:binding;
            table "events";
        }

        dropUser2 extends dropUser1 {
          failOnSqlError true;
        }

    }
  }

sfConfig extends TableManipulationTest {



}