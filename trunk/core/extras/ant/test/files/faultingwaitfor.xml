<?xml version="1.0"?>
<project name="parse" default="teardown">

  <description>
    Tests for the parse.

    command line invocation
    ant -lib ..\..\build\dist\lib\smartfrog-tasks.jar -lib ..\..\..\..\smartfrog\dist\lib\smartfrog.jar -lib -f faultingwaitfor.xml testTimeout

    ant -lib ../../dist/lib/ -lib ../../../../smartfrog/dist/lib/ -f faultingwaitfor.xml testTimeout

    ant -lib ../../build/dist/lib/smartfrog-tasks.jar -lib
    ../../../../smartfrog/dist/lib/smartfrog.jar -lib
    ../../../../smartfrog/dist/lib/sfExamples.jar -f deploy.xml testResource
  </description>
  <import file="test-common.xml"/>

  <target name="testSuccess">
    <sf-faultingwaitfor maxwait="2" >
      <equals arg1="a" arg2="a" />
    </sf-faultingwaitfor>
  </target>

  <target name="testSuccessPropertyUnset">
    <sf-faultingwaitfor maxwait="2"
        timeoutproperty="timeout" >
      <equals arg1="a" arg2="a"/>
    </sf-faultingwaitfor>
    <fail if="timeout" >timeout property was set</fail>
  </target>

  <target name="testTimeout">
    <echo>in</echo>
    <waitfor timeoutproperty="foo" maxwait="2">
      <equals arg1="a" arg2="b"/>
    </waitfor>
    <sf-faultingwaitfor maxwait="2" >
      <equals arg1="a" arg2="b"/>
    </sf-faultingwaitfor>
    <echo>we should never get here</echo>
  </target>

  <target name="testTimeoutMessage">
    <sf-faultingwaitfor maxwait="2" message="equality failed">
      <equals arg1="a" arg2="b"/>
    </sf-faultingwaitfor>
  </target>

  <target name="testTimeoutProperty">
    <sf-faultingwaitfor maxwait="2"
        timeoutproperty="timeout">
      <equals arg1="a" arg2="a"/>
    </sf-faultingwaitfor>
    <fail if="timeout">timeout property was set</fail>
  </target>

  <target name="teardown" />
</project>